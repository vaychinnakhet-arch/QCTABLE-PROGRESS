
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QC UPDATE | Professional Dashboard</title>
  <link rel="stylesheet" href="index.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-left">
        <h1>QC PROJECT UPDATE</h1>
        <p class="subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á | By VAY CHINNAKHET</p>
      </div>
      <div class="header-right" style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap; justify-content: flex-end;">
        <div class="date-badge">
          <span id="current-date-display" class="value">-- / -- / --</span>
        </div>
        <div class="sync-status">
          <span id="sync-dot" class="dot"></span>
          <span id="status-indicator">Online</span>
        </div>
        <div class="btn-group" style="display: flex; gap: 8px;">
          <button id="capture-btn" class="btn btn-purple">üì∏ ‡πÅ‡∏Ñ‡∏õ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏†‡∏≤‡∏û</button>
          <button id="export-excel-btn" class="btn btn-green">üìä Excel</button>
          <div class="dropdown" style="position: relative; display: inline-block;">
            <button class="btn" style="background: #f1f5f9;">‚öôÔ∏è JSON</button>
            <div class="dropdown-content" style="display: none; position: absolute; right: 0; background: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 6px; border: 1px solid #cbd5e1; z-index: 10;">
              <button id="export-json-btn" style="display: block; width: 100%; text-align: left; padding: 8px 12px; border: none; background: none; cursor: pointer; font-size: 12px;">Export JSON</button>
              <button id="import-json-btn" style="display: block; width: 100%; text-align: left; padding: 8px 12px; border: none; background: none; cursor: pointer; font-size: 12px;">Import JSON</button>
            </div>
          </div>
        </div>
        <input type="file" id="import-json-input" style="display: none;" accept=".json">
      </div>
    </header>

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏Ñ‡∏õ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏†‡∏≤‡∏û -->
    <div id="capture-area" style="background: white; padding: 10px; border-radius: 8px;">
      <div class="table-wrapper">
        <table id="main-schedule-table">
          <thead></thead>
          <tbody></tbody>
          <tfoot>
            <tr style="background: #f8fafc; font-weight: 800;">
              <td colspan="1">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
              <td id="total-neua-fa-plan"></td><td id="total-neua-fa-sent"></td>
              <td id="total-qc-ww-plan"></td><td id="total-qc-ww-sent"></td>
              <td id="total-qc-end-plan"></td><td id="total-qc-end-sent"></td>
              <td colspan="100"></td>
            </tr>
          </tfoot>
        </table>
      </div>

      <div class="summary-section summary-container">
        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢ JS -->
      </div>
    </div>
  </div>

  <div id="popover" class="popover" style="display: none;">
    <div style="font-size: 11px; font-weight: 700; color: #64748b; margin-bottom: 5px;">‡∏õ‡πâ‡∏≠‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</div>
    <input type="number" id="popover-input" class="popover-input">
    <div class="popover-tasks">
      <button data-task="neua-fa" class="task-btn btn-neua">‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏ú‡πâ‡∏≤</button>
      <button data-task="qc-ww" class="task-btn btn-ww">QC WW</button>
      <button data-task="qc-end" class="task-btn btn-end">QC End</button>
    </div>
    <div style="display: flex; gap: 5px; margin-top: 10px;">
      <button id="popover-clear" class="btn" style="flex: 1; color: #ef4444;">‡∏•‡πâ‡∏≤‡∏á</button>
      <button id="popover-cancel" class="btn" style="flex: 1;">‡∏õ‡∏¥‡∏î</button>
    </div>
  </div>

  <style>
    .dropdown:hover .dropdown-content { display: block !important; }
    .dropdown-content button:hover { background: #f1f5f9 !important; }
  </style>

  <script type="module" src="index.js"></script>
</body>
</html>
